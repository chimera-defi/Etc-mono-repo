# Wallet Data Scripts

Automation scripts for refreshing wallet comparison data.

## Scripts

### `generate_merchant_feed.py` (Merchant Center)

Generates a basic Google Merchant Center feed from the wallet comparison tables.

#### Usage

```bash
./generate_merchant_feed.py
```

#### Output

- `wallets/artifacts/merchant-center.xml`

**Note:** Prices are set to `0 USD` by default because structured pricing is not stored in the tables yet. Update the script once pricing data is available.

### `refresh-github-data.sh` (Software Wallets)

Queries GitHub for **EVM software wallet** activity.

Queries the GitHub API to get the latest commit dates and activity status for all tracked wallet repositories.

#### Usage

```bash
# Basic usage - outputs to stdout
./refresh-github-data.sh

# JSON output for programmatic use
./refresh-github-data.sh --json

# Markdown table for documentation
./refresh-github-data.sh --markdown
```

#### Output Formats

**Text (default):**
```
=== Wallet GitHub Activity Check ===
Generated: 2025-12-01

MetaMask        MetaMask/metamask-extension           2025-11-27    4 days  ✅ Active
Rabby           RabbyHub/Rabby                        2025-11-21   10 days  ✅ Active
...
```

**JSON (`--json`):**
```json
{
  "generated": "2025-12-01",
  "wallets": [
    {"wallet": "MetaMask", "repo": "MetaMask/metamask-extension", "lastCommit": "2025-11-27", "daysAgo": 4, "status": "✅"},
    ...
  ]
}
```

**Markdown (`--markdown`):**
```markdown
| Wallet | Repository | Last Commit | Days Ago | Status |
|--------|------------|-------------|----------|--------|
| **MetaMask** | [MetaMask/metamask-extension](https://github.com/MetaMask/metamask-extension) | 2025-11-27 | 4 | ✅ Active |
...
```

#### GitHub API Rate Limits

- **Without token:** 60 requests/hour (enough for ~17 repos)
- **With token:** 5,000 requests/hour

Set the `GITHUB_TOKEN` environment variable for higher rate limits:

```bash
export GITHUB_TOKEN=ghp_xxxxxxxxxxxxxxxxxxxx
./refresh-github-data.sh
```

#### Activity Status Definitions

| Status | Days Since Last Commit | Meaning |
|--------|------------------------|---------|
| ✅ Active | ≤30 days | Actively maintained |
| ⚠️ Slow | 31-120 days | Reduced activity |
| ❌ Inactive | >120 days | Likely abandoned |

## GitHub Actions

The repository includes a GitHub Actions workflow (`.github/workflows/refresh-wallet-data.yml`) that:

1. Runs automatically every Monday at 9:00 AM UTC
2. Can be triggered manually via workflow_dispatch
3. Creates a PR with updated activity data

### Manual Trigger

1. Go to Actions → Refresh Wallet Data
2. Click "Run workflow"
3. Optionally enable "Dry run" to skip PR creation

## Data Directory

The `data/` directory contains:

- `activity.json` - Machine-readable activity data (generated by workflow)

---

### `refresh-hardware-wallet-data.sh` (Hardware Wallets)

Queries GitHub for **hardware wallet firmware** activity. Includes stars, issues, and issue/star ratio.

#### Usage

```bash
# Basic usage - outputs to stdout
./refresh-hardware-wallet-data.sh

# JSON output for programmatic use
./refresh-hardware-wallet-data.sh --json

# Markdown table for documentation
./refresh-hardware-wallet-data.sh --markdown
```

#### Tracked Hardware Wallets

| Wallet | Repository |
|--------|------------|
| Trezor | trezor/trezor-firmware |
| Keystone | KeystoneHQ/keystone3-firmware |
| BitBox02 | BitBoxSwiss/bitbox02-firmware |
| ColdCard | Coldcard/firmware |
| Foundation Passport | Foundation-Devices/passport2 |
| OneKey | OneKeyHQ/firmware-pro |
| KeepKey | keepkey/keepkey-firmware |

**Closed Source (not tracked):** Ledger, NGRAVE, Ellipal, SafePal, SecuX, Tangem, BC Vault, GridPlus

---

## Adding New Wallets

### For Software Wallets

To track a new wallet, add it to the `REPOS` and `WALLET_NAMES` arrays in `refresh-github-data.sh`:

### For Hardware Wallets

Add to the `REPOS` and `WALLET_NAMES` arrays in `refresh-hardware-wallet-data.sh`:

### Common Format

```bash
REPOS=(
    ...
    "owner/repo-name"  # Add new repo
)

WALLET_NAMES=(
    ...
    "Wallet Name"      # Add display name (same index)
)
```

## Requirements

- `bash` (4.0+)
- `curl`
- `jq`
- `date` (GNU or BSD)
